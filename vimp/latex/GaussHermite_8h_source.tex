\hypertarget{GaussHermite_8h_source}{}\doxysection{Gauss\+Hermite.\+h}
\label{GaussHermite_8h_source}\index{include/GaussHermite.h@{include/GaussHermite.h}}
\mbox{\hyperlink{GaussHermite_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 }
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include <eigen3/Eigen/Dense>}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include <boost/math/special\_functions/factorials.hpp>}}
\DoxyCodeLine{15 \textcolor{keyword}{using namespace }Eigen;}
\DoxyCodeLine{16 \textcolor{keyword}{using namespace }std;}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{keyword}{namespace}\{}
\DoxyCodeLine{19     \textcolor{keyword}{template} <\textcolor{keyword}{typename} Function>}
\DoxyCodeLine{20 \textcolor{keyword}{class }GaussHermite\{}
\DoxyCodeLine{21 \textcolor{keyword}{public}:}
\DoxyCodeLine{25     GaussHermite()\{\}}
\DoxyCodeLine{35     GaussHermite(\textcolor{keyword}{const} \textcolor{keywordtype}{int}\& p, \textcolor{keyword}{const} \textcolor{keywordtype}{int}\& dim, \textcolor{keyword}{const} VectorXd\& mean, \textcolor{keyword}{const} MatrixXd\& P, \textcolor{keyword}{const} Function\& func):}
\DoxyCodeLine{36         p\_\{p\},}
\DoxyCodeLine{37         dim\_\{dim\},}
\DoxyCodeLine{38         mean\_\{mean\},}
\DoxyCodeLine{39         P\_\{P\},}
\DoxyCodeLine{40         f\_\{func\},}
\DoxyCodeLine{41         W\_\{VectorXd::Zero(p\_)\},}
\DoxyCodeLine{42         sigmapts\_\{VectorXd::Zero(p\_)\}\{\}}
\DoxyCodeLine{43 }
\DoxyCodeLine{48     \textcolor{keywordtype}{void} getSigmaPts()\{}
\DoxyCodeLine{49         VectorXd a\{VectorXd::Ones(p\_-\/1)\};}
\DoxyCodeLine{50         VectorXd c\{VectorXd::LinSpaced(p\_-\/1, 1, p\_-\/1)\};}
\DoxyCodeLine{51         VectorXd c\_over\_a = (c.array() / a.array()).matrix();}
\DoxyCodeLine{52         MatrixXd L\{MatrixXd::Zero(p\_, p\_)\};}
\DoxyCodeLine{53         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0; i<p\_-\/1; i++)\{}
\DoxyCodeLine{54             L(i+1, i) = c\_over\_a(i);}
\DoxyCodeLine{55             L(i, i+1) = a(i);}
\DoxyCodeLine{56         \}}
\DoxyCodeLine{57 }
\DoxyCodeLine{58         sigmapts\_ = L.eigenvalues().real();}
\DoxyCodeLine{59     \}}
\DoxyCodeLine{60 }
\DoxyCodeLine{68     \textcolor{keywordtype}{double} HermitePolynomial(\textcolor{keyword}{const} \textcolor{keywordtype}{int}\& deg, \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& x)\{}
\DoxyCodeLine{69         \textcolor{keywordflow}{if} (deg == 0) \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{70         \textcolor{keywordflow}{if} (deg == 1) \textcolor{keywordflow}{return} x;}
\DoxyCodeLine{71         \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{72             \textcolor{keywordtype}{double} H0 = 1;}
\DoxyCodeLine{73             \textcolor{keywordtype}{double} H1 = x;}
\DoxyCodeLine{74             \textcolor{keywordtype}{double} H2 = x*x -\/ 1;}
\DoxyCodeLine{75             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=3; i<deg+1; i++)\{}
\DoxyCodeLine{76                 H0 = H1;}
\DoxyCodeLine{77                 H1 = H2;}
\DoxyCodeLine{78                 H2 = x*H1 -\/ (i-\/1)*H0;}
\DoxyCodeLine{79             \}}
\DoxyCodeLine{80             \textcolor{keywordflow}{return} H2;}
\DoxyCodeLine{81         \}}
\DoxyCodeLine{82     \}}
\DoxyCodeLine{83 }
\DoxyCodeLine{89     VectorXd getWeights()\{}
\DoxyCodeLine{90         getSigmaPts();}
\DoxyCodeLine{91         VectorXd W(p\_);}
\DoxyCodeLine{92         \textcolor{keywordtype}{int} cnt = 0;}
\DoxyCodeLine{93         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{double} i\_pt : sigmapts\_)\{}
\DoxyCodeLine{94             W(cnt) = boost::math::factorial<double>(p\_) / p\_ / p\_ / HermitePolynomial(p\_-\/1, i\_pt) / HermitePolynomial(p\_-\/1, i\_pt);}
\DoxyCodeLine{95             cnt += 1;}
\DoxyCodeLine{96         \}}
\DoxyCodeLine{97         W\_ = W;}
\DoxyCodeLine{98         \textcolor{keywordflow}{return} W;}
\DoxyCodeLine{99     \}}
\DoxyCodeLine{100 }
\DoxyCodeLine{106     MatrixXd Integrate()\{}
\DoxyCodeLine{107 }
\DoxyCodeLine{108         getWeights();}
\DoxyCodeLine{109         LLT<MatrixXd> lltP(P\_);}
\DoxyCodeLine{110         MatrixXd sig\{lltP.matrixL()\};}
\DoxyCodeLine{111 }
\DoxyCodeLine{112         VectorXd pt\_0 = VectorXd::Zero(dim\_);}
\DoxyCodeLine{113         }
\DoxyCodeLine{114         MatrixXd res\{MatrixXd::Zero(f\_(pt\_0).rows(), f\_(pt\_0).cols())\};}
\DoxyCodeLine{115         }
\DoxyCodeLine{116         \textcolor{keywordflow}{if} (dim\_ == 1)\{}
\DoxyCodeLine{117             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0; i<p\_; i++)\{}
\DoxyCodeLine{118                 res += W\_(i)*f\_(sig*sigmapts\_(i) + mean\_);}
\DoxyCodeLine{119             \}}
\DoxyCodeLine{120         \}}
\DoxyCodeLine{121 }
\DoxyCodeLine{122         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dim\_ == 2) \{}
\DoxyCodeLine{123             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < p\_; i++) \{}
\DoxyCodeLine{124                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < p\_; j++) \{}
\DoxyCodeLine{125                     VectorXd pt\_ij = VectorXd::Zero(dim\_);}
\DoxyCodeLine{126                     pt\_ij << sigmapts\_(i), sigmapts\_(j);}
\DoxyCodeLine{127 }
\DoxyCodeLine{128                     VectorXd pt\_ij\_t = sig * pt\_ij + mean\_;}
\DoxyCodeLine{129                     res += W\_(i) * W\_(j) * f\_(pt\_ij\_t);}
\DoxyCodeLine{130 }
\DoxyCodeLine{131                 \}}
\DoxyCodeLine{132             \}}
\DoxyCodeLine{133         \}}
\DoxyCodeLine{134         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dim\_ == 3)\{}
\DoxyCodeLine{135             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0; i<p\_; i++)\{}
\DoxyCodeLine{136                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0; j<p\_; j++)\{}
\DoxyCodeLine{137                     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} k=0; k<p\_; k++)\{}
\DoxyCodeLine{138                         VectorXd pt\_ijk = VectorXd::Zero(dim\_);}
\DoxyCodeLine{139                         pt\_ijk << sigmapts\_(i), sigmapts\_(j), sigmapts\_(k);}
\DoxyCodeLine{140 }
\DoxyCodeLine{141                         VectorXd pt\_ijk\_t = sig * pt\_ijk + mean\_;}
\DoxyCodeLine{142                         res += W\_(i) * W\_(j) * W\_(k) * f\_(pt\_ijk\_t);}
\DoxyCodeLine{143                     \}}
\DoxyCodeLine{144                 \}}
\DoxyCodeLine{145             \}}
\DoxyCodeLine{146         \}}
\DoxyCodeLine{147         \textcolor{comment}{// else if (dim\_ == 4)\{}}
\DoxyCodeLine{148         \textcolor{comment}{//     for (int i=0; i<p\_; i++)\{}}
\DoxyCodeLine{149         \textcolor{comment}{//         for(int j=0; j<p\_; j++)\{}}
\DoxyCodeLine{150         \textcolor{comment}{//             for(int k=0; k<p\_; k++)\{}}
\DoxyCodeLine{151         \textcolor{comment}{//                 for (int l=0; l<p\_; l++)\{}}
\DoxyCodeLine{152         \textcolor{comment}{//                     VectorXd pt\_ijkl(4);}}
\DoxyCodeLine{153         \textcolor{comment}{//                     pt\_ijkl << sigmapts\_(i), sigmapts\_(j), sigmapts\_(k), sigmapts\_(l);}}
\DoxyCodeLine{154         \textcolor{comment}{//                     VectorXd pt\_ijkl\_t = sig * pt\_ijkl + mean\_;}}
\DoxyCodeLine{155         \textcolor{comment}{//                     res += W\_(i) * W\_(j) * W\_(k) * W\_(l) * f\_(pt\_ijkl\_t);}}
\DoxyCodeLine{156         \textcolor{comment}{//                 \}}}
\DoxyCodeLine{157         \textcolor{comment}{//             \}}}
\DoxyCodeLine{158         \textcolor{comment}{//         \}}}
\DoxyCodeLine{159         \textcolor{comment}{//     \}}}
\DoxyCodeLine{160 }
\DoxyCodeLine{161         \textcolor{comment}{// \}}}
\DoxyCodeLine{162         }
\DoxyCodeLine{163         \textcolor{keywordflow}{return} res;}
\DoxyCodeLine{164     \}}
\DoxyCodeLine{165 }
\DoxyCodeLine{169     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} update\_mean(\textcolor{keyword}{const} VectorXd\& mean)\{}
\DoxyCodeLine{170         mean\_ = mean;}
\DoxyCodeLine{171     \}}
\DoxyCodeLine{172 }
\DoxyCodeLine{173     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} update\_P(\textcolor{keyword}{const} MatrixXd\& P)\{}
\DoxyCodeLine{174         P\_ = P;}
\DoxyCodeLine{175     \}}
\DoxyCodeLine{176 }
\DoxyCodeLine{177     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} set\_p(\textcolor{keyword}{const} \textcolor{keywordtype}{int}\& p)\{}
\DoxyCodeLine{178         p\_ = p;}
\DoxyCodeLine{179     \}}
\DoxyCodeLine{180 }
\DoxyCodeLine{181     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} update\_integrand(\textcolor{keyword}{const} Function\& fun)\{}
\DoxyCodeLine{182         f\_ = fun;}
\DoxyCodeLine{183     \}}
\DoxyCodeLine{184 }
\DoxyCodeLine{185     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} update\_dimension(\textcolor{keyword}{const} \textcolor{keywordtype}{int}\& dim)\{}
\DoxyCodeLine{186         dim\_ = dim;}
\DoxyCodeLine{187     \}}
\DoxyCodeLine{188 }
\DoxyCodeLine{189 \textcolor{keyword}{private}:}
\DoxyCodeLine{190     \textcolor{keywordtype}{int} p\_;}
\DoxyCodeLine{191     \textcolor{keywordtype}{int} dim\_;}
\DoxyCodeLine{192     VectorXd mean\_;}
\DoxyCodeLine{193     MatrixXd P\_;}
\DoxyCodeLine{194     Function f\_;}
\DoxyCodeLine{195     VectorXd W\_;}
\DoxyCodeLine{196     VectorXd sigmapts\_;}
\DoxyCodeLine{197 \};}
\DoxyCodeLine{198 }
\DoxyCodeLine{199 \}}

\end{DoxyCode}
