\hypertarget{OptimizerPlanarPointRobotGH_8h_source}{}\doxysection{Optimizer\+Planar\+Point\+Robot\+GH.\+h}
\label{OptimizerPlanarPointRobotGH_8h_source}\index{include/OptimizerPlanarPointRobotGH.h@{include/OptimizerPlanarPointRobotGH.h}}
\mbox{\hyperlink{OptimizerPlanarPointRobotGH_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 }
\DoxyCodeLine{16 }
\DoxyCodeLine{17 \textcolor{preprocessor}{\#include <gtsam/base/Matrix.h>}}
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#include <random>}}
\DoxyCodeLine{20 \textcolor{preprocessor}{\#include <utility>}}
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{SparseInverseMatrix_8h}{SparseInverseMatrix.h}}"{}}}
\DoxyCodeLine{22 }
\DoxyCodeLine{23 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{OptimizerFactorizedPriorCollisionPointRobot_8h}{OptimizerFactorizedPriorCollisionPointRobot.h}}"{}}}
\DoxyCodeLine{24 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{OptimizerFactorizedPriorPointRobot_8h}{OptimizerFactorizedPriorPointRobot.h}}"{}}}
\DoxyCodeLine{25 \textcolor{preprocessor}{\#include <boost/scoped\_ptr.hpp>}}
\DoxyCodeLine{26 }
\DoxyCodeLine{27 \textcolor{comment}{//using namespace GaussianSampler;}}
\DoxyCodeLine{28 \textcolor{keyword}{using namespace }std;}
\DoxyCodeLine{29 \textcolor{keyword}{using namespace }SparseInverse;}
\DoxyCodeLine{30 \textcolor{keyword}{typedef} Triplet<double> T;}
\DoxyCodeLine{31 }
\DoxyCodeLine{32 \textcolor{keyword}{namespace }MPVI\{}
\DoxyCodeLine{33     \textcolor{keyword}{template} <\textcolor{keyword}{typename} FunctionPrior, \textcolor{keyword}{typename} FunctionPriorCol>}
\DoxyCodeLine{34 }
\DoxyCodeLine{38 \textcolor{keyword}{class }\mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH}{VIMPOptimizerPlanarPointRobotGH}}\{}
\DoxyCodeLine{39     \textcolor{comment}{// using FactorizedOptimizerPriorGH = OptimizerFactorPriorPointRobotGH<FunctionPrior, ArgsPrior ...>;}}
\DoxyCodeLine{40     \textcolor{comment}{// using FactorizedOptimizerPriorColGH = OptimizerFactorPriorColPointRobotGH<FunctionPriorCol, ArgsPriCol ...>;}}
\DoxyCodeLine{41 }
\DoxyCodeLine{42 \textcolor{keyword}{public}:}
\DoxyCodeLine{49     \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a8e3a83085f79d3e591366535139e53da}{VIMPOptimizerPlanarPointRobotGH}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int}\& dimension, \textcolor{keyword}{const} \textcolor{keywordtype}{int}\& sub\_dim, \textcolor{keyword}{const} vector<FunctionPrior>\& \_vec\_func\_priors,}
\DoxyCodeLine{50                     \textcolor{keyword}{const} vector<FunctionPriorCol>\& \_vec\_func\_prior\_cols, \textcolor{keyword}{const} vector<MatrixXd>\& \_vec\_Pks\_prior, \textcolor{keyword}{const} vector<MatrixXd>\& \_vec\_Pks\_prior\_col):}
\DoxyCodeLine{51                                    \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a5d7ce71ca0bca3a0379a17bd83c07248}{dim}}\{dimension\},}
\DoxyCodeLine{52                                    sub\_dim\{sub\_dim\},}
\DoxyCodeLine{53                                    num\_sub\_vars\{static\_cast<int>(\_vec\_Pks\_prior\_col.size())\},}
\DoxyCodeLine{54                                    \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a61b940598a22d1be0b842c1b82403cfc}{vec\_cost\_func\_prior\_col\_}}\{\_vec\_func\_prior\_cols\},}
\DoxyCodeLine{55                                    \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a09f5cd99a94a7891ed84dc9347da9b3e}{vec\_cost\_func\_prior\_}}\{\_vec\_func\_priors\},}
\DoxyCodeLine{56                                    \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_aad80d07b21d0bcbd61a151cbaa73bbd5}{vecPks\_prior\_}}\{\_vec\_Pks\_prior\},}
\DoxyCodeLine{57                                    \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_acc483448967514e5c9d52bd803fc2f63}{vecPks\_prior\_col\_}}\{\_vec\_Pks\_prior\_col\},}
\DoxyCodeLine{58                                    \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a11d2d9cf7dbbe3daacce0e5a0cf768de}{mu\_}}\{VectorXd::Zero(dimension)\},}
\DoxyCodeLine{59                                    d\_mu\_\{VectorXd::Zero(dimension)\},}
\DoxyCodeLine{60                                    precision\_\{MatrixXd::Identity(\mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a5d7ce71ca0bca3a0379a17bd83c07248}{dim}}, \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a5d7ce71ca0bca3a0379a17bd83c07248}{dim}}) * 5.0\},}
\DoxyCodeLine{61                                    d\_precision\_(MatrixXd::Identity(\mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a5d7ce71ca0bca3a0379a17bd83c07248}{dim}}, \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a5d7ce71ca0bca3a0379a17bd83c07248}{dim}})),}
\DoxyCodeLine{62                                    Vdmu\_\{VectorXd::Zero(dimension)\},}
\DoxyCodeLine{63                                    Vddmu\_(MatrixXd::Identity(\mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a5d7ce71ca0bca3a0379a17bd83c07248}{dim}}, \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a5d7ce71ca0bca3a0379a17bd83c07248}{dim}})),}
\DoxyCodeLine{64                                    \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a484ab2b796e2a206f0220c190037c289}{inverser\_}}\{MatrixXd::Identity(\mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a5d7ce71ca0bca3a0379a17bd83c07248}{dim}}, \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a5d7ce71ca0bca3a0379a17bd83c07248}{dim}})\}}
\DoxyCodeLine{65     \{\}}
\DoxyCodeLine{66 \textcolor{keyword}{protected}:}
\DoxyCodeLine{68     \textcolor{keywordtype}{int} \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a5d7ce71ca0bca3a0379a17bd83c07248}{dim}}, sub\_dim, num\_sub\_vars;}
\DoxyCodeLine{69 }
\DoxyCodeLine{74     VectorXd \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a11d2d9cf7dbbe3daacce0e5a0cf768de}{mu\_}}, Vdmu\_, d\_mu\_;}
\DoxyCodeLine{75     MatrixXd precision\_, Vddmu\_, d\_precision\_;}
\DoxyCodeLine{76 }
\DoxyCodeLine{78     vector<OptimizerFactorPriorPointRobotGH> \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a9fb35e83cb63477018198a1bf8cb22c9}{vec\_factor\_optimizers\_prior\_}};}
\DoxyCodeLine{79     vector<OptimizerFactorPriorColPointRobotGH> vec\_factor\_optimizers\_prior\_col\_;}
\DoxyCodeLine{80 }
\DoxyCodeLine{82     \textcolor{keyword}{const} vector<FunctionPriorCol> \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a61b940598a22d1be0b842c1b82403cfc}{vec\_cost\_func\_prior\_col\_}};}
\DoxyCodeLine{83     }
\DoxyCodeLine{85     \textcolor{keyword}{const} vector<FunctionPrior> \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a09f5cd99a94a7891ed84dc9347da9b3e}{vec\_cost\_func\_prior\_}};}
\DoxyCodeLine{86 }
\DoxyCodeLine{88     \textcolor{keyword}{const} vector<MatrixXd> \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_aad80d07b21d0bcbd61a151cbaa73bbd5}{vecPks\_prior\_}};}
\DoxyCodeLine{89 }
\DoxyCodeLine{91     \textcolor{keyword}{const} vector<MatrixXd> \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_acc483448967514e5c9d52bd803fc2f63}{vecPks\_prior\_col\_}};}
\DoxyCodeLine{92 }
\DoxyCodeLine{94     \mbox{\hyperlink{structSparseInverse_1_1dense__inverser}{dense\_inverser}} \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a484ab2b796e2a206f0220c190037c289}{inverser\_}};}
\DoxyCodeLine{95     \textcolor{keywordtype}{double} step\_size\_precision = 0.9;}
\DoxyCodeLine{96     \textcolor{keywordtype}{double} step\_size\_mu = 0.9;}
\DoxyCodeLine{97 }
\DoxyCodeLine{98 \textcolor{keyword}{public}:}
\DoxyCodeLine{100     \textcolor{keywordtype}{void} \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a69e461bd667a1517e2b647e95f72c74c}{step}}()\{}
\DoxyCodeLine{101         cout << \textcolor{stringliteral}{"{}mu\_ "{}} << endl << \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a11d2d9cf7dbbe3daacce0e5a0cf768de}{mu\_}} << endl;}
\DoxyCodeLine{102 }
\DoxyCodeLine{103         Vdmu\_.setZero();}
\DoxyCodeLine{104         Vddmu\_.setZero();}
\DoxyCodeLine{105         d\_mu\_.setZero();}
\DoxyCodeLine{106         d\_precision\_.setZero();}
\DoxyCodeLine{107 }
\DoxyCodeLine{108         MatrixXd Sigma\{\mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a484ab2b796e2a206f0220c190037c289}{inverser\_}}.\mbox{\hyperlink{structSparseInverse_1_1dense__inverser_a58b2afee2028386c8410837a0c11db85}{inverse}}(precision\_)\};}
\DoxyCodeLine{109 }
\DoxyCodeLine{110         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k=0; k<num\_sub\_vars; k++)\{}
\DoxyCodeLine{111 }
\DoxyCodeLine{112             \textcolor{keyword}{const} MatrixXd\& Pk\_prior = \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_aad80d07b21d0bcbd61a151cbaa73bbd5}{vecPks\_prior\_}}[k];}
\DoxyCodeLine{113             \textcolor{keyword}{const} MatrixXd\& Pk\_prior\_col = \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_acc483448967514e5c9d52bd803fc2f63}{vecPks\_prior\_col\_}}[k];}
\DoxyCodeLine{114 }
\DoxyCodeLine{115             \textcolor{keyword}{auto} \&optimizer\_prior\_k = \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a9fb35e83cb63477018198a1bf8cb22c9}{vec\_factor\_optimizers\_prior\_}}[k];}
\DoxyCodeLine{116             \textcolor{keyword}{auto} \&optimizer\_prior\_col\_k = vec\_factor\_optimizers\_prior\_col\_[k];}
\DoxyCodeLine{117             }
\DoxyCodeLine{119             optimizer\_prior\_k.update\_mu(VectorXd\{Pk\_prior*\mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a11d2d9cf7dbbe3daacce0e5a0cf768de}{mu\_}}\});}
\DoxyCodeLine{120             optimizer\_prior\_k.update\_precision(MatrixXd\{(Pk\_prior * Sigma * Pk\_prior.transpose()).inverse()\});}
\DoxyCodeLine{121             optimizer\_prior\_k.calculate\_partial\_V();}
\DoxyCodeLine{122 }
\DoxyCodeLine{123             Vdmu\_ = Vdmu\_ + Pk\_prior.transpose() * optimizer\_prior\_k.get\_Vdmu();}
\DoxyCodeLine{124             Vddmu\_ = Vddmu\_ + Pk\_prior.transpose().eval() * optimizer\_prior\_k.get\_Vddmu() * Pk\_prior;}
\DoxyCodeLine{125 }
\DoxyCodeLine{127             optimizer\_prior\_col\_k.update\_mu(VectorXd\{Pk\_prior\_col * \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a11d2d9cf7dbbe3daacce0e5a0cf768de}{mu\_}}\});}
\DoxyCodeLine{128             optimizer\_prior\_col\_k.update\_precision(MatrixXd\{(Pk\_prior\_col * Sigma * Pk\_prior\_col.transpose()).inverse()\});}
\DoxyCodeLine{129             optimizer\_prior\_col\_k.calculate\_partial\_V();}
\DoxyCodeLine{130 }
\DoxyCodeLine{131             Vdmu\_ = Vdmu\_ + Pk\_prior\_col.transpose() * optimizer\_prior\_col\_k.get\_Vdmu();}
\DoxyCodeLine{132             Vddmu\_ = Vddmu\_ + Pk\_prior\_col.transpose().eval() * optimizer\_prior\_col\_k.get\_Vddmu() * Pk\_prior\_col;}
\DoxyCodeLine{133 }
\DoxyCodeLine{134         \}}
\DoxyCodeLine{135 }
\DoxyCodeLine{136         d\_precision\_ = -\/precision\_ + Vddmu\_;}
\DoxyCodeLine{137 }
\DoxyCodeLine{138         precision\_ = precision\_ + step\_size\_precision*d\_precision\_;}
\DoxyCodeLine{139 }
\DoxyCodeLine{140         d\_mu\_ = precision\_.colPivHouseholderQr().solve(-\/Vdmu\_);}
\DoxyCodeLine{141 }
\DoxyCodeLine{142         \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a11d2d9cf7dbbe3daacce0e5a0cf768de}{mu\_}} = \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a11d2d9cf7dbbe3daacce0e5a0cf768de}{mu\_}} + step\_size\_mu * d\_mu\_;}
\DoxyCodeLine{143 }
\DoxyCodeLine{144         cout << \textcolor{stringliteral}{"{}mu\_ "{}} << endl << \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a11d2d9cf7dbbe3daacce0e5a0cf768de}{mu\_}} << endl;}
\DoxyCodeLine{145         cout << \textcolor{stringliteral}{"{}new precision "{}} << endl << precision\_ << endl;}
\DoxyCodeLine{146 }
\DoxyCodeLine{147     \}}
\DoxyCodeLine{148 }
\DoxyCodeLine{150     gtsam::Vector \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a94120f59d1f9e07a71d95ca3441cca6d}{get\_mean}}()\{}
\DoxyCodeLine{151         \textcolor{keywordflow}{return} \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a11d2d9cf7dbbe3daacce0e5a0cf768de}{mu\_}};}
\DoxyCodeLine{152     \}}
\DoxyCodeLine{153 }
\DoxyCodeLine{155     gtsam::Matrix \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a4dced91f661825ac9c44aff2b485cf76}{get\_precision}}()\{}
\DoxyCodeLine{156         \textcolor{keywordflow}{return} precision\_;}
\DoxyCodeLine{157     \}}
\DoxyCodeLine{158 }
\DoxyCodeLine{160     gtsam::Matrix \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_afc2e86d58259f073e2006342d9d48b20}{get\_covariance}}()\{}
\DoxyCodeLine{161         \textcolor{keywordflow}{return} \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a484ab2b796e2a206f0220c190037c289}{inverser\_}}.\mbox{\hyperlink{structSparseInverse_1_1dense__inverser_a58b2afee2028386c8410837a0c11db85}{inverse}}();}
\DoxyCodeLine{162     \}}
\DoxyCodeLine{163 }
\DoxyCodeLine{167     \textcolor{keywordtype}{void} \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a480dd41aa57d244d136f526ea9f7988a}{set\_step\_size}}(\textcolor{keywordtype}{double} ss\_mean, \textcolor{keywordtype}{double} ss\_precision)\{}
\DoxyCodeLine{168         step\_size\_mu = ss\_mean;}
\DoxyCodeLine{169         step\_size\_precision = ss\_precision;}
\DoxyCodeLine{170     \}}
\DoxyCodeLine{171 }
\DoxyCodeLine{174     \textcolor{keywordtype}{void} \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a75d76dab012389932c98c4704a2e08e4}{set\_mu}}(\textcolor{keyword}{const} VectorXd\& mean)\{}
\DoxyCodeLine{175         \mbox{\hyperlink{classMPVI_1_1VIMPOptimizerPlanarPointRobotGH_a11d2d9cf7dbbe3daacce0e5a0cf768de}{mu\_}} = mean;}
\DoxyCodeLine{176     \}}
\DoxyCodeLine{177 }
\DoxyCodeLine{178 \};}
\DoxyCodeLine{179 }
\DoxyCodeLine{180 \}}

\end{DoxyCode}
